<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoleditPy チュートリアル 4: S<sub>N</sub>2反応と遷移状態</title>
    <link rel="stylesheet" href="tutorial_style.css">
    <style>
        body {
            font-family: "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Yu Gothic", Meiryo, sans-serif;
        }

        .step-img {
            width: 100%;
            max-width: 600px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 1rem 0;
            display: block;
        }

        .note {
            background-color: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-size: 0.9em;
        }
    </style>
    <link rel="icon" href="img/favicon.ico" type="image/x-icon">
</head>

<body>
    <div class="container">
        <header>
            <h1>MoleditPy PySCF Calculator Plugin Tutorial</h1>
            <h2>4. S<sub>N</sub>2反応のスキャンと遷移状態探索</h2>
            <p style="margin-top: 0.5rem; opacity: 0.8; font-size: 0.9rem;">(計算レベル: B3LYP/ma-def2-svp)</p>
        </header>

        <nav class="tutorial-nav">
            <details>
                <summary>チュートリアルメニュー</summary>
                <ul>
                    <li><a href="index.html">ホーム</a></li>
                    <li><a href="tutorial_00_setup_jp.html">0. セットアップ</a></li>
                    <li><a href="tutorial_01_butadiene_jp.html">1. ブタジエン</a></li>
                    <li><a href="tutorial_02_ethane_jp.html">2. エタン</a></li>
                    <li><a href="tutorial_03_acetone_jp.html">3. アセトン</a></li>
                    <li><a href="tutorial_04_sn2_jp.html" class="active">4. S<sub>N</sub>2反応</a></li>
                </ul>
            </details>
        </nav>

        <section>
            <h2>目的</h2>
            <p>クロロメタン(CH<sub>3</sub>Cl)と臭化物イオン(Br<sup>-</sup>)のS<sub>N</sub>2置換反応を題材に、反応座標のスキャン計算(Relaxed
                Scan)を行い、エネルギー障壁を見積もります。さらに、その構造を初期値として遷移状態(TS)計算と振動解析を行い、虚振動を確認します。</p>
        </section>

        <section>
            <h2>操作手順</h2>

            <h3>Step 1: 分子の描画と配置</h3>
            <ol class="step-list">
                <li><strong>分子の描画:</strong>
                    <ul>
                        <li>クロロメタン (CH<sub>3</sub>Cl) を描画します。</li>
                        <li>その近くに臭化物イオン (Br<sup>-</sup>) を描画します。</li>
                    </ul>
                </li>
                <li><strong>3D変換:</strong>
                    <ul>
                        <li>ツールバーの "Convert 2D to 3D" を押して3D構造に変換します。</li>
                    </ul>
                    <img src="img/sn2_01_mol_draw.png" alt="分子描画と3D変換" class="step-img">
                </li>
                <li><strong>位置調整:</strong>
                    <ul>
                        <li>"3D Edit > Move Group..." ツール等を使い、Br<sup>-</sup> を炭素原子の背面攻撃側（Clの反対側）に配置します。</li>
                    </ul>
                    <img src="img/sn2_02_move.png" alt="Group移動" class="step-img">
                </li>
                <li><strong>結合距離の調整:</strong>
                    <ul>
                        <li>"3D Edit > Adjust Bond Length..." ツールを使い、C-Br間の距離を <strong>2.8 Å</strong> に設定します。</li>
                    </ul>
                    <img src="img/sn2_03_bond_len.png" alt="距離調整 2.8A" class="step-img">
                </li>
            </ol>

            <h3>Step 2: リラックススキャン計算 (Relaxed Scan)</h3>
            <ol class="step-list">
                <li><strong>PySCF Calculatorの起動:</strong>
                    <ul>
                        <li>Extensions > PySCF Calculator を開きます。</li>
                    </ul>
                </li>
                <li><strong>スキャン設定:</strong>
                    <ul>
                        <li>Modeを <strong>Relaxed Surface Scan</strong> に設定します。</li>
                        <li>"Configure Scan" ボタンを押し、Distanceタブで以下のように設定します:
                            <ul>
                                <li><strong>Start:</strong> 2.8 Å</li>
                                <li><strong>End:</strong> 1.96 Å</li>
                                <li><strong>Steps:</strong> 5</li>
                            </ul>
                        </li>
                        <li>この設定は、BrがCに近づいていく過程を計算します。</li>
                    </ul>
                    <img src="img/sn2_05_scan_config.png" alt="Scan Config設定" class="step-img">
                </li>
                <li><strong>計算レベルの設定:</strong>
                    <ul>
                        <li><strong>Method:</strong> RKS (B3LYP)</li>
                        <li><strong>Basis:</strong> ma-def2-svp</li>
                        <li><span class="note">注: アニオンの計算には ma-def2-svp のような拡散基底関数(diffuse
                                function)を含む基底関数が推奨されます。STO-3Gより時間がかかります。</span></li>
                    </ul>
                </li>
                <li><strong>計算実行:</strong> "Run Calculation" をクリックします。時間がかかるので待ちます。</li>
            </ol>

            <h3>Step 3: エネルギー図と遷移状態の推定</h3>
            <ol class="step-list">
                <li><strong>結果の確認:</strong>
                    <ul>
                        <li>計算終了後、Energy Diagramを確認します。活性化エネルギー障壁(山なりのグラフ)が表示されているはずです。</li>
                        <li>アニメーション再生ボタンを押し、反応の様子を確認します。</li>
                    </ul>
                    <img src="img/sn2_profile.png" alt="エネルギープロファイル" class="step-img">
                    <p style="font-size: 0.9em; color: #555;">（グラフの右側はC-Br距離が長い初期状態：CH<sub>3</sub>Cl +
                        Br<sup>-</sup>、左側はC-Br距離が短い生成物側：CH<sub>3</sub>Br + Cl<sup>-</sup>を表します）</p>
                    <img src="img/sn2_scan_animation.gif" alt="スキャンアニメーション" class="step-img">
                </li>
                <li><strong>TS候補の選択:</strong>
                    <ul>
                        <li>グラフ上の <strong>最もエネルギーが高い点(Highest Point)</strong> をクリックします。</li>
                        <li>これにより、そのステップの構造がメイン画面に反映されます。これが遷移状態(TS)の良き初期構造となります。</li>
                    </ul>
                    <img src="img/sn2_08_select_highest.png" alt="TS候補の選択" class="step-img">
                </li>
            </ol>

            <h3>Step 4: 遷移状態(TS)計算と振動解析</h3>
            <ol class="step-list">
                <li><strong>計算設定の変更:</strong>
                    <ul>
                        <li>Calculationタブに戻ります。</li>
                        <li><strong>Job Type:</strong> <code>TS Optimization + Frequency</code> に変更します。</li>
                        <li>その他の設定(B3LYP / ma-def2-svp)は変更しません。</li>
                    </ul>
                    <img src="img/sn2_11_ts_setup.png" alt="TS計算設定" class="step-img">
                </li>
                <li><strong>計算実行:</strong> 再度 "Run Calculation" をクリックします。</li>
            </ol>

            <h3>Step 5: 虚振動の確認</h3>
            <ol class="step-list">
                <li><strong>振動モードの確認:</strong>
                    <ul>
                        <li>計算完了後、Vibrational Modesリストを確認します。</li>
                        <li><strong>負の振動数 (Imaginary Frequency)</strong> が1つだけ存在することを確認します。これは遷移状態であることを示します。</li>
                        <li>そのモードを選択し、アニメーションで原子が反応座標に沿って動いていることを確認します。</li>
                    </ul>
                    <img src="img/sn2_13_imag_mode.png" alt="虚振動の確認" class="step-img">
                    <img src="img/sn2_img-mode.gif" alt="虚振動アニメーション" class="step-img">
                </li>
            </ol>
        </section>

        <div class="nav-links">
            <a href="tutorial_03_acetone_jp.html" class="btn btn-secondary">&larr; アセトンに戻る</a>
            <a href="index.html" class="btn">ホームに戻る &rarr;</a>
        </div>
    </div>
</body>

</html>